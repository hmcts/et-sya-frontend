{% extends "govuk/template.njk" %}
{% from "govuk/components/header/macro.njk" import govukHeader %}
{% from "govuk/components/footer/macro.njk" import govukFooter %}
{% from "govuk/components/phase-banner/macro.njk" import govukPhaseBanner %}

{% block head %}
  {% include "webpack/css.njk" %}
{% endblock %}

{% block header %}
  {{ govukHeader({
    homepageUrl: "https://www.gov.uk",
    serviceName: serviceName,
    serviceUrl: "#"
  }) }}
{% endblock %}

{% block pageTitle %}
  {{ title }}
  -
  {{ govUk }}
{% endblock %}

{% block beforeContent %}
  {% set phaseBarHtml = '<a class="govuk-link" href="#" target="_blank">' + phaseBanner.feedback + "</a> " + phaseBanner.additionalText %}

  {% if "lng=cy" in currentUrl %}
    {% set phaseBarText = "Lorem" %}
  {% else %}
    {% set phaseBarText = "beta" %}
  {% endif %}

  {% if welshEnabled %}
    {% set queryStringConcat = "" %}

    {% if "lng=" in currentUrl %}
      {% set currentUrl = currentUrl | replace("?lng=en", "") | replace("&lng=en", "") | replace("?lng=cy", "") | replace("&lng=cy", "") %}
    {% endif %}

    {% if "?" not in currentUrl %}
      {% set queryStringConcat = "?" %}
    {% else %}
      {% set queryStringConcat = "&" %}
    {% endif %}

    {% set languageFlag = "" %}
    {% if i18n.language == "en" %}
      {% set languageFlag = queryStringConcat + "lng=cy" %}
    {% else %}
      {% set languageFlag = queryStringConcat + "lng=en" %}
    {% endif %}

    {% set phaseBarHtml = phaseBarHtml + (phaseBanner.languageToggle | replace("{currentUrl}", currentUrl) | replace("{languageFlag}", languageFlag)) %}
  {% endif %}

  {{ govukPhaseBanner({
      tag: {
          text: phaseBarText
      },
      html: phaseBarHtml
  }) }}
{% endblock %}

{% block bodyEnd %}
  {# Run JavaScript at end of the <body>, to avoid blocking the initial render. #}
  {% include "webpack/js.njk" %}
{% endblock %}

{% block footer %}
  {% if "/" !== currentUrl %}
    <div class="govuk-width-container">
      <details class="govuk-details govuk-!-margin-top-8" data-module="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            {{ contactUsTitle }}
          </span>
        </summary>
        <div class="govuk-details__text">
          {{ contactUsForHelp|safe }}
        </div>
      </details>
    </div>
  {% endif %}
  {% if "lng=cy" in currentUrl %}
    <footer class="govuk-footer " role="contentinfo">
      <div class="govuk-width-container ">
        <div class="govuk-footer__meta">
          <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">
            <h2 class="govuk-visually-hidden">Support links</h2>
            <ul class="govuk-footer__inline-list">
              <li class="govuk-footer__inline-list-item">
                <a class="govuk-footer__link" href="/guide">
                  Lorem
                </a>
              </li>
              <li class="govuk-footer__inline-list-item">
                <a class="govuk-footer__link" href="/terms-and-conditions">
                  Lorem ipsum dolor
                </a>
              </li>
              <li class="govuk-footer__inline-list-item">
                <a class="govuk-footer__link" href="/cookies">
                  Lorem
                </a>
              </li>
              <li class="govuk-footer__inline-list-item">
                <a class="govuk-footer__link" href="/contact-us">
                  Lorem ipsum
                </a>
              </li>
            </ul>

            <svg aria-hidden="true" focusable="false" class="govuk-footer__licence-logo" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 483.2 195.7" height="17" width="41">
              <path fill="currentColor" d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"/>
            </svg>
            <span class="govuk-footer__licence-description">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc id tempus risus. Ut tortor
            </span>
          </div>
          <div class="govuk-footer__meta-item">
            <a class="govuk-footer__link govuk-footer__copyright-logo" href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/">Â© Lorem ipsum</a>
          </div>
        </div>
      </div>
    </footer>
  {% else %}
    {{ govukFooter({
  meta: {
    items: [
      {
          href: "/guide",
          text: guide
      },
      {
          href: "/terms-and-conditions",
          text: termsAndConditions
      },
      {
          href: "/cookies",
          text: cookiePolicy
      },
      {
          href: "/contact-us",
          text: contact
      }
    ]
  }
}) }}
  {% endif %}
{% endblock %}