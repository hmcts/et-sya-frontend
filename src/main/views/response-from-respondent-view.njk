{% extends "template.njk" %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "components/hmcts-progress-bar/macro.njk" import hmctsProgressBar %}
{%- from "govuk/components/tag/macro.njk" import govukTag -%}
{% from "govuk/components/details/macro.njk" import govukDetails %}
{% from "govuk/components/table/macro.njk" import govukTable %}

{% block beforeContent %}
  {{ super() }}
  {% include "back-link.njk"%}
{% endblock %}

{% block content %}

  <div class="govuk-grid-row">

    <div class="govuk-grid-column-two-thirds-from-desktop">
      <h1 class="govuk-heading-xl">
        {{h1}}
      </h1>

      {% set documentsRows = [] %}

      {% for docType, docs in { 'responseEt3': et3AcceptedDocs, 'rejectionLetter': et3RejectionDocs, 'et3FormText': et3Forms, 'supportingMaterials': et3SupportingDocs } %}
        {% for doc in docs %}
          {% set href = docType == 'responseEt3' or docType == 'rejectionLetter'
            ? '/case-document/' + (docType == 'responseEt3' ? 'response-acknowledgement' : 'response-rejection')
            : '/getCaseDocument/' + doc.id
          %}
          {% set documentsRows = (documentsRows.push(
            [
              { text: doc.createdOn },
              { text: docType },
              { html: "<a href=\"" + href + "\" target=\"_blank\" class=\"govuk-link\">" + doc.originalDocumentName + "</a>" }
            ]
          ), documentsRows) %}
        {% endfor %}
      {% endfor %}

      {{ govukTable({
        captionClasses: "govuk-table__caption--m",
        rows: documentsRows
      }) }}

    </div>

    <div class="govuk-grid-column-one-third-from-desktop">

      {% set sideBarContent %}
        {% include "./citizen-hub-sidebar.njk" %}
      {% endset %}

      {{ govukDetails({
        summaryText: contact,
        html: sideBarContent
      }) }}

    </div>

  </div>

{% endblock %}
